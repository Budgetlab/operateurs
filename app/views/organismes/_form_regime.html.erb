<% if @organisme.statut != "valide" %>
  <h1 class="fr-my-6w">Création d'un organisme</h1>
  <div class="fr-stepper">
    <h2 class="fr-stepper__title">
      <span class="fr-stepper__state">Étape 2 sur 6</span>
      Régime budgétaire et comptable
    </h2>
    <div class="fr-stepper__steps" data-fr-current-step="2" data-fr-steps="6"></div>
    <p class="fr-stepper__details">
      <span class="fr-text--bold">Étape suivante :</span> Contrôle
    </p>
  </div>
<%else %>
  <h1 class="fr-my-6w">Modification</h1>
<%end %>

<div class="fr-mt-4w" data-controller="form">
  <%= form_with(model: @organisme, data: {'form-target': "form", action: "change->form#validateFormStep2 turbo:before-fetch-request->form#validateFormStep2"}) do |f|%>
    <% if @organisme.statut != "valide" %>
      <%= f.hidden_field :statut, value: "2" %>
    <%end %>
      <div class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-12 fr-col-lg-4">
          <fieldset class="fr-fieldset">
            <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w">
              Partie I GBCP* <span class="fr-hint-text">Si "Non", pas de soumission à la GBCP</span>
            </legend>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                  <%= f.radio_button :gbcp_1, true, id: "radio-gbcp-1", checked: @organisme.gbcp_1, data: {'form-target': 'checkRequire', action: "change->form#ChangeGBCP1" }  %>
                <label class="fr-label" for="radio-gbcp-1">Oui</label>
              </div>
            </div>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :gbcp_1, false, checked: @organisme.gbcp_1 == false, id:"radio-gbcp", data: {'form-target': 'checkRequire', action: "change->form#ChangeGBCP1" } %>
                <label class="fr-label" for="radio-gbcp">Non</label>
              </div>
            </div>
          </fieldset>

          <fieldset class="fr-fieldset" >
            <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w">
              Présence d'un agent comptable
            </legend>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :agent_comptable_present, true, id: "radio-agent-1", checked: @organisme.agent_comptable_present  %>
                <label class="fr-label" for="radio-agent-1">Oui</label>
              </div>
            </div>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :agent_comptable_present, false, checked: @organisme.agent_comptable_present == false, id:"radio-agent" %>
                <label class="fr-label" for="radio-agent">Non</label>
              </div>
            </div>
          </fieldset>

          <div class="fr-select-group">
            <label for="degre_gbcp" class="fr-label">Champ d'application du décret GBCP<span class="fr-hint-text"> Appartenance aux bulles de l’article 1er du GBCP à retrouver sur https://www.legifrance.gouv.fr/loda/id/JORFTEXT000026597003 </span></label>
            <%= f.select :degre_gbcp,[["- sélectionner -",""],['3°','3°'],['4°','4°'],["5°",'5°'],["6°",'6°'],["Exclusion",'Exclusion']],{selected: @organisme.degre_gbcp}, {id:"degre_gbcp",class:"fr-select"}%>
          </div>

          <fieldset class="fr-fieldset">
            <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w">
              Partie III GBCP*
            </legend>

            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :gbcp_3, true, id: "radio-gbcp-3", checked: @organisme.gbcp_3, data: {'form-target': 'checkRequire', action: "change->form#ChangeGBCP3" }   %>
                <label class="fr-label" for="radio-gbcp-3">Oui</label>
              </div>
            </div>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :gbcp_3, false, checked: @organisme.gbcp_3 == false, id:"radio-gbcp-3N", data: {'form-target': 'checkRequire', action: "change->form#ChangeGBCP3" }  %>
                <label class="fr-label" for="radio-gbcp-3N">Non</label>
              </div>
            </div>
          </fieldset>

          <fieldset class="fr-fieldset">
            <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
              Comptabilité budgétaire*
            </legend>

            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :comptabilite_budgetaire, "oui", id: "radio-compta-1", checked: @organisme.comptabilite_budgetaire == "oui", data: {'form-target': 'checkRequire'}  %>
                <label class="fr-label" for="radio-compta-1">Oui</label>
              </div>
            </div>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :comptabilite_budgetaire, "Oui mais adapté", checked: @organisme.comptabilite_budgetaire == "Oui mais adapté", id:"radio-compta-b", data: {'form-target': 'checkRequire'} %>
                <label class="fr-label" for="radio-compta-b">Oui mais adapté</label>
              </div>
            </div>
            <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                <%= f.radio_button :comptabilite_budgetaire, "non", checked: @organisme.comptabilite_budgetaire == "non", id:"radio-compta", data: {'form-target': 'checkRequire'} %>
                <label class="fr-label" for="radio-compta">Non</label>
              </div>
            </div>
          </fieldset>
        </div>
      </div>

      <div class="fr-my-4w">
        <%= f.submit "Valider et passer à l'étape suivante", class: "fr-btn", data: {'form-target': "submitBouton"}, aria: { label: "Valider"}, disabled: true %>
      </div>
  <%end %>
</div>